var SMI_Magnify=class{overlay=null;constructor(imageRatio,sectionEl){this.sectionEl=sectionEl||document,this.enableZoomOnHover(imageRatio)}createOverlay(image){const overlayImage=document.createElement("img");return overlayImage.setAttribute("src",`${image.src}`),this.overlay=document.createElement("div"),this.prepareOverlay(this.overlay,overlayImage),image.style.opacity="50%",overlayImage.onload=()=>{image.parentElement.insertBefore(this.overlay,image),image.style.opacity="100%"},this.overlay}prepareOverlay(container,image){container.setAttribute("class","smi-image-magnify-full-size"),container.setAttribute("aria-hidden","true"),container.style.backgroundImage=`url('${image.src}')`,container.style.backgroundColor="var(--gradient-background)",container.style.backgroundRepeat="no-repeat",container.style.width="100%",container.style.height="100%",container.style.top="0",container.style.left="0",container.style.position="absolute",container.style.zIndex="3",container.style.cursor="zoom-out"}moveWithHover(image,event,zoomRatio){const ratio=image.height/image.width,container=event.target.getBoundingClientRect(),xPosition=event.clientX-container.left,yPosition=event.clientY-container.top,xPercent=xPosition/(image.clientWidth/100)+"%",yPercent=yPosition/(image.clientWidth*ratio/100)+"%";this.overlay.style.backgroundPosition=`${xPercent} ${yPercent}`,this.overlay.style.backgroundSize=image.width*zoomRatio+"px"}magnify(image,zoomRatio){const overlay=this.createOverlay(image);overlay.onclick=event=>{this.moveWithHover(image,event,zoomRatio),overlay.remove()},overlay.onmousemove=event=>this.moveWithHover(image,event,zoomRatio),overlay.onmouseleave=()=>overlay.remove()}enableZoomOnHover(zoomRatio){this.sectionEl.querySelectorAll(".smi-image-magnify-hover").forEach((image=>{image.onclick=event=>{this.magnify(image,zoomRatio),this.moveWithHover(image,event,zoomRatio)}}))}},SMI_ProductGallery=function(){"use strict";return class{swiperThumb=null;swiperMain=null;sectionEl=null;lightbox=null;variantsMainSlide=[];variantsThumbnailSlide=[];constructor(sectionID){this.sectionEl=document.querySelector(`#${sectionID}`),this.sectionId=sectionID.replace("smi-",""),this._init(this.sectionEl)}_init(sectionEl){if("object"!=typeof sectionEl)return null;this.sectionEl=sectionEl,this._handleLayout(),this._handleZoomSetting(),this._handleVariantProduct(),this._handleColorForLightbox(),this._addAltToImgInVideoUpload()}_handleLayout(){const gallery=this.sectionEl.querySelector(".smi-product-gallery");let desktopLayout=gallery.getAttribute("data-desktop-layout"),mobileLayout=gallery.getAttribute("data-mobile-layout");const swiperThumbnail=gallery.querySelector(".smi-product-gallery__thumbnail");let oldLayout=null;const layoutWithSwiper=["vertical-thumbnails","horizontal-thumbnails","pagination","2-columns-carousel"],layoutWithThumbnail=["vertical-thumbnails","horizontal-thumbnails"],changeLayout=(layout,isMobile)=>{if(layout===oldLayout)return null;oldLayout=layout,gallery.className=this._clearLayout(gallery.className),gallery?.classList.add("smi-product-gallery--layout-"+layout),layoutWithSwiper.includes(layout)?(this._detroySwiper(),this._initSwiper(isMobile,layout)):this._detroySwiper(),layoutWithThumbnail.includes(layout)?swiperThumbnail?.classList.remove("smi-d-none","smi-d-md-none"):swiperThumbnail?.classList.add("smi-d-none","smi-d-md-none")},mediaQuery=window.matchMedia("(min-width: 768px)"),handleClickWithParam=event=>{event.preventDefault(),event.stopPropagation(),this._handleMediaPlayOnDesktop(event.currentTarget)},tabletChange=e=>{e.matches?(changeLayout(desktopLayout),this.sectionEl.querySelectorAll(".smi-media").forEach((el=>{el.classList.contains("smi-media--image")||el.addEventListener("click",handleClickWithParam)}))):(changeLayout(mobileLayout,!0),this.sectionEl.querySelectorAll(".smi-media").forEach((el=>{el.classList.contains("smi-media--image")||(el.querySelector(".smi-preview-image")?.classList.remove("smi-d-none"),el.removeEventListener("click",handleClickWithParam))})))};tabletChange(mediaQuery),mediaQuery.addListener(tabletChange)}_clearLayout(className){return className.replace(/\s+/g," ").split(" ").filter((function(c){return 0!==c.lastIndexOf("smi-product-gallery--layout-",0)})).join(" ").trim()}_detroySwiper(){this.swiperMain?.initialized&&this.swiperMain.destroy(),this.swiperThumb?.initialized&&this.swiperThumb.destroy()}_updateSwiper(){this.swiperMain?.initialized&&this.swiperMain.update(),this.swiperThumb?.initialized&&this.swiperThumb.update()}_initSwiper(isMobile,layout){if("undefined"==typeof Swiper)return null;this.sectionEl.querySelector(".smi-product-gallery__thumbnail")&&(this.swiperThumb=this._initSwiperThumbnail()),this.sectionEl.querySelector(".smi-product-gallery__slider")&&(this.swiperMain=this._initSwiperMain(isMobile,layout))}_handleZoomSetting(){const g=this.sectionEl.querySelector(".smi-product-gallery");if(g.classList.contains("smi-image-zoom-open-lightbox")&&this.initlightbox(),g.classList.contains("smi-image-zoom-click-and-hover")&&"function"==typeof SMI_Magnify){const mediaQuery=window.matchMedia("(min-width: 768px)"),tabletChange=e=>{if(e.matches)new SMI_Magnify(2,this.sectionEl),this.lightbox&&this.lightbox.destroy();else{g.querySelectorAll(".smi-product-gallery__slider .smi-media--image").forEach((el=>{el.querySelector(".smi-media__image-item").addEventListener("click",(e=>e.target.click()))})),this.initlightbox()}};tabletChange(mediaQuery),mediaQuery.addListener(tabletChange)}}_handleButtonZoom(swiper){try{this.sectionEl.querySelectorAll(".smi-media__icon-zoom").forEach((el=>{el.addEventListener("click",(e=>{e.target.closest(".smi-media").querySelector(".smi-image-magnify-hover")?.click()}))}))}catch(err){console.log(err.message)}}_pauseAllVideo(swiper){this.sectionEl.querySelectorAll(".smi-media--video video").forEach((video=>{video.pause()})),this.sectionEl.querySelectorAll(".smi-media--external-video iframe").forEach((video=>{video.contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*"),video.contentWindow.postMessage('{"method":"pause"}',"*")}))}_initSwiperThumbnail(){const options={loop:!1,slidesPerView:"auto",watchSlidesProgress:!0,autoHeight:!0,resizeObserver:!0,navigation:{nextEl:this.sectionEl.querySelector(".smi-product-gallery__thumbnail .swiper-button-next"),prevEl:this.sectionEl.querySelector(".smi-product-gallery__thumbnail .swiper-button-prev")}};null!==this.sectionEl.querySelector(".smi-product-gallery--layout-vertical-thumbnails")?options.direction="vertical":options.direction="horizontal";const swiperEl=this.sectionEl.querySelector(".smi-product-gallery__thumbnail .smi-slide-wrap");return new Swiper(swiperEl,options)}_initSwiperMain(isMobile,layout){const options={init:!0,noSwipingClass:"smi-no-swiping",loop:!0,autoHeight:!0,updateOnWindowResize:!0,watchSlidesProgress:!0,slidesPerView:"auto",navigation:{nextEl:this.sectionEl.querySelector(".smi-product-gallery__slider .swiper-button-next"),prevEl:this.sectionEl.querySelector(".smi-product-gallery__slider .swiper-button-prev")},pagination:{el:this.sectionEl.querySelector(".smi-product-gallery__slider .smi-controls__counter"),type:"fraction"},thumbs:{swiper:this.swiperThumb},breakpoints:{768:{autoHeight:!0}},on:{slideChange:swiper=>{this._pauseAllVideo(swiper),this._handleButtonZoom(swiper)},transitionEnd:()=>{window.dispatchEvent(new Event("resize")),this._handleMediaPlayOnSlide()},afterInit:swiper=>{this._handleButtonZoom(swiper),this._handlePagination(swiper)}}};isMobile&&"2-columns-carousel"===layout&&(options.autoHeight=!1);const swiperEl=this.sectionEl.querySelector(".smi-product-gallery__slider .smi-slide-wrap");return new Swiper(swiperEl,options)}initlightbox(){const gallery=this.sectionEl?.querySelector(".smi-product-gallery__slider"),lightbox=new PhotoSwipeLightbox({gallery:gallery,children:"a",mainClass:"smi-lightbox",bgOpacity:1,pswpModule:PhotoSwipe,closeOnVerticalDrag:!1});lightbox.init(),this.lightbox=lightbox,this._syncLightboxWithSwiper(lightbox),this._addControlButtonToLightbox(lightbox),this._customLightboxContent(lightbox),lightbox.on("pointerMove",(e=>{"MODEL-VIEWER"===e.originalEvent.target.tagName&&e.preventDefault()}))}_syncLightboxWithSwiper(lightbox){const swiper=this.swiperMain;if(!swiper)return null;lightbox.on("change",(()=>{const{pswp:pswp}=lightbox;swiper.slideTo(pswp.currIndex,0,!1)})),lightbox.on("afterInit",(()=>{swiper.params?.autoplay.enabled&&swiper?.autoplay.stop()})),lightbox.on("closingAnimationStart",(()=>{const{pswp:pswp}=lightbox;swiper.slideTo(pswp.currIndex,0,!1),swiper.params?.autoplay.enabled&&swiper?.autoplay.start()}))}_addControlButtonToLightbox(lightbox){lightbox.on("uiRegister",(function(){lightbox.pswp.ui.registerElement({name:"customButton",className:"pswp__custom-button",appendTo:"wrapper",onInit:(el,pswp)=>{let btnPrev,btnNext,btnClose;btnPrev=document.createElement("div"),btnPrev.className="smi-btn-prev",btnPrev.innerHTML='<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="arrow-right-2"><path id="Vector" d="M5.26835 2.22168C5.39502 2.22168 5.52169 2.26835 5.62169 2.36835L9.96835 6.71501C10.675 7.42168 10.675 8.58168 9.96835 9.28835L5.62169 13.635C5.42835 13.8283 5.10835 13.8283 4.91502 13.635C4.72169 13.4417 4.72169 13.1217 4.91502 12.9283L9.26169 8.58168C9.58169 8.26168 9.58169 7.74168 9.26169 7.42168L4.91502 3.07501C4.72169 2.88168 4.72169 2.56168 4.91502 2.36835C5.01502 2.27501 5.14169 2.22168 5.26835 2.22168Z" fill="#1B1B1B"/></g></svg>',btnPrev.onclick=e=>{pswp.prev()},el.appendChild(btnPrev),btnClose=document.createElement("div"),btnClose.className="smi-btn-close",btnClose.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" height="48" viewBox="0 -960 960 960" width="48"><path d="m249-207-42-42 231-231-231-231 42-42 231 231 231-231 42 42-231 231 231 231-42 42-231-231-231 231Z"/></svg>',btnClose.onclick=e=>{pswp.close()},el.appendChild(btnClose),btnNext=document.createElement("div"),btnNext.className="smi-btn-next",btnNext.innerHTML='<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="arrow-right-2"><path id="Vector" d="M5.26835 2.22168C5.39502 2.22168 5.52169 2.26835 5.62169 2.36835L9.96835 6.71501C10.675 7.42168 10.675 8.58168 9.96835 9.28835L5.62169 13.635C5.42835 13.8283 5.10835 13.8283 4.91502 13.635C4.72169 13.4417 4.72169 13.1217 4.91502 12.9283L9.26169 8.58168C9.58169 8.26168 9.58169 7.74168 9.26169 7.42168L4.91502 3.07501C4.72169 2.88168 4.72169 2.56168 4.91502 2.36835C5.01502 2.27501 5.14169 2.22168 5.26835 2.22168Z" fill="#1B1B1B"/></g></svg>',btnNext.onclick=e=>{pswp.next()},el.appendChild(btnNext)}})}))}_customLightboxContent(lightbox){lightbox.addFilter("itemData",((itemData,index)=>{const html=itemData.element.dataset.pswpHtml;return html&&(itemData.html=html),itemData}))}_handlePagination(swiper){const next=this.sectionEl.querySelector(".smi-controls__next"),prev=this.sectionEl.querySelector(".smi-controls__prev");next&&next.addEventListener("click",(e=>{swiper.slideNext(0)})),prev&&prev.addEventListener("click",(e=>{swiper.slidePrev(0)}))}_handleVariantProduct(){const galleryWrap=this.sectionEl.querySelector(".smi-product-gallery");galleryWrap.classList.contains("smi-hide-variants")?(this._handleHideOtherVariant(galleryWrap,this.isSlide(galleryWrap)),document.addEventListener("smiVariantChange",(e=>{const id=e.detail.id;this.sectionId===e.detail.sectionId&&this._changeVariantSlide(galleryWrap,id,this.isSlide(galleryWrap))}))):document.addEventListener("smiVariantChange",(e=>{const id=e.detail.id;this.sectionId===e.detail.sectionId&&this._handleVariantImageToTop(galleryWrap,id,this.isSlide(galleryWrap))}))}isSlide(galleryWrap){const elementClasses=Array.from(galleryWrap.classList);return["vertical-thumbnails","horizontal-thumbnails","pagination","2-columns-carousel"].some((className=>elementClasses.includes("smi-product-gallery--layout-"+className)))}_handleVariantImageToTop(galleryWrap,variantId,isSlide=!0){const mainSlide=galleryWrap.querySelector(".smi-product-gallery__slider .swiper-wrapper"),thumbSlide=galleryWrap.querySelector(".smi-product-gallery__thumbnail .swiper-wrapper");function moveSlideToTop(slideWrapper,variantId){const slideNodes=slideWrapper.querySelectorAll(".swiper-slide");for(const slide of slideNodes){const v=slide.getAttribute("data-attached-variant");if(v&&v.includes(variantId)){slideWrapper.prepend(slide);break}}}isSlide&&(mainSlide&&mainSlide.parentElement?.swiper.destroy(),thumbSlide&&thumbSlide.parentElement?.swiper.destroy()),thumbSlide&&moveSlideToTop(thumbSlide,variantId),mainSlide&&moveSlideToTop(mainSlide,variantId),isSlide&&this._initSwiper()}_handleHideOtherVariant(galleryWrap,isSlide=!0){const mainSlide=galleryWrap.querySelector(".smi-product-gallery__slider .swiper-wrapper"),thumbSlide=galleryWrap.querySelector(".smi-product-gallery__thumbnail .swiper-wrapper");function archiveSlide(slideWrapper){const slideNodes=slideWrapper.querySelectorAll(".swiper-slide"),arr=[];let loop=0;for(const slide of slideNodes)slide.hasAttribute("data-attached-variant")&&(arr.push(slide),loop>0&&slide.remove()),loop++;return arr}isSlide&&(mainSlide.parentElement?.swiper.destroy(),thumbSlide.parentElement?.swiper.destroy()),mainSlide&&(this.variantsMainSlide=archiveSlide(mainSlide)),thumbSlide&&(this.variantsThumbnailSlide=archiveSlide(thumbSlide)),isSlide&&this._initSwiper()}_changeVariantSlide(galleryWrap,variantId,isSlide=!0){const mainSlide=galleryWrap.querySelector(".smi-product-gallery__slider .swiper-wrapper"),thumbSlide=galleryWrap.querySelector(".smi-product-gallery__thumbnail .swiper-wrapper");function changeFirstSlide(slideWrapper,archiveArray,variantId){const firstChild=slideWrapper.children[0];firstChild&&firstChild.hasAttribute("data-attached-variant")&&slideWrapper.removeChild(firstChild);const slide=archiveArray.find((item=>item.getAttribute("data-attached-variant").includes(variantId)));slide&&slideWrapper.prepend(slide)}isSlide&&(mainSlide.parentElement?.swiper.destroy(),thumbSlide.parentElement?.swiper.destroy()),mainSlide&&changeFirstSlide(mainSlide,this.variantsMainSlide,variantId),thumbSlide&&changeFirstSlide(thumbSlide,this.variantsThumbnailSlide,variantId),isSlide&&this._initSwiper()}_handleMediaPlayOnSlide(){const screenChangeSize=e=>{if(e.matches){const mediaWrap=this.sectionEl.querySelector(".smi-product-gallery__slider .swiper-slide-active .smi-media");mediaWrap&&this._handleMediaPlayOnDesktop(mediaWrap)}},mediaQuery=window.matchMedia("(min-width: 768px)");screenChangeSize(mediaQuery),mediaQuery.addListener(screenChangeSize)}_handleMediaPlayOnDesktop(mediaWrap){mediaWrap.querySelector(".smi-hook-lightbox").addEventListener("click",(event=>{window.innerWidth>=768&&!mediaWrap.classList.contains("smi-media--image")&&(event.preventDefault(),event.stopPropagation())}));const cover=mediaWrap.querySelector(".smi-preview-image");cover&&!cover.classList.contains("smi-d-none")&&(cover.classList.add("smi-d-none"),this.playVideo(mediaWrap))}playVideo(mediaWrap){const videoExternal=mediaWrap.getAttribute("data-media-host")??!1,videoUpload=mediaWrap.querySelector(".smi-video-upload video");if("vimeo"===videoExternal&&mediaWrap.querySelector("iframe").contentWindow.postMessage('{"method":"play"}',"*"),"youtube"===videoExternal&&mediaWrap.querySelector("iframe").contentWindow.postMessage('{"event":"command","func":"playVideo","args":""}',"*"),videoUpload){let timeout;clearTimeout(timeout),timeout=setTimeout((()=>videoUpload.play()),150)}}_handleColorForLightbox(){const computedStyle=getComputedStyle(this.sectionEl),bg=computedStyle.getPropertyValue("--color-background"),cl=computedStyle.getPropertyValue("--color-foreground");let styleElement=document.createElement("style"),cssContent=`\n                .smi-lightbox {\n                    --color-background: ${bg};\n                    --color-foreground: ${cl};\n                }\n            `;styleElement.appendChild(document.createTextNode(cssContent)),(document.head||document.getElementsByTagName("head")[0]).appendChild(styleElement)}_addAltToImgInVideoUpload(){this.sectionEl.querySelectorAll(".smi-video-upload").forEach((el=>{const img=el.querySelector("img");img&&img.setAttribute("alt","video")}))}}}();